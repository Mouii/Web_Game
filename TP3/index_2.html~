<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Events test</title>
	<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js" type="text/javascript"></script><script language="javascript" src="javascripts/jquery.hotkeys.js" type="text/javascript"></script><script language="javascript" src="javascripts/key_status.js" type="text/javascript"></script><script language="javascript" src="javascripts/util.js" type="text/javascript"></script><script language="javascript" src="javascripts/sprite.js" type="text/javascript"></script><script language="javascript" src="javascripts/sound.js" type="text/javascript"></script>
    </head>
    <body>
    </body>
<script type='text/javascript'>
	//Tutorial game html5 and javascript
	
	var CANVAS_WIDTH = 500;
	var CANVAS_HEIGHT = 300;
	
	var image = new Image();
	image.src = "hero.png";//Selection of the source of the image
	image.alt = "Outch";//if there is any problem, this message will be displayed	

	var canvasElement = document.createElement("canvas");
	var canvas = canvasElement.getContext("2d");
	canvasElement.id = "canvas";
	canvasElement.width = CANVAS_WIDTH;
	canvasElement.height = CANVAS_HEIGHT;
	canvasElement.setAttribute('tabindex','1');
	canvasElement.focus();
	var theCanvas = document.body.appendChild(canvasElement);
	
	var moving = 0;//moving will be use for the cutting from the image
	
	var leftMove = 0;
	var rightMove = 128;
	var upMove = 384;
	var downMove = 256;
	
		var player = {
		x: 100,
		y: 100,
		width: 32,
		height: 32,
		move : rightMove,
		draw: function() {
			canvas.drawImage(image, moving, this.move, 128, 128, this.x, this.y,128,128);//Function drawing the basic picture
		}
	};
	
	//This variable is needed for the animation Frame
	window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
                              window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
	
	theCanvas.addEventListener("keydown", function (e) {
		var code = e.keyCode;
    		switch (code) {
       			case 37:  //Left key
       			       	if (player.move != leftMove) {
       					player.move = leftMove;
       					moving = 0;
       				}
       				player.x -= 5;
       				moving += 128;
       				moving = moving%512;
       				break;
        		case 38: //Up key
       				if (player.move != upMove) {
       					player.move = upMove;
       					moving = 0;
       				}
        			player.y -= 5;
        			moving += 128;
       				moving = moving%512;
        			break; 
       			case 39: //Right key
       				if (player.move != rightMove) {
       					player.move = rightMove;
       					moving = 0;
       				}
       				player.x += 5;
       				moving += 128;
       				moving = moving%512;
       				break;
        		case 40: //Down key
              			if (player.move != downMove) {
       					player.move = downMove;
       					moving = 0;
       				}
        			player.y += 5;
        	       		moving += 128;
       				moving = moving%512;
        			break; 
        		default: 
        			break; //Everything else
   		}
	}, false);


	function update() {
	}
	
	function draw() {
		canvas.clearRect (0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
		player.draw();
		requestAnimationFrame(draw);
	}

	requestAnimationFrame(draw);

	//This variable is needed for the animation Frame
	/*window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
                              window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;

	var canvas = document.getElementById("testing");//We pick up the canvas
     	var context = canvas.getContext("2d");//This variable picks up the context which allow us to custom the canvas
	var image = new Image();
	image.src = "hero.png";//Selection of the source of the image
	image.alt = "Outch";//if there is any problem, this message will be displayed

	var cursorImg = 0;//This variable will be important for the selection of the sprite

	context.drawImage(image, 0, 128, 128, 128, 150,150,128,128);//Function drawing the basic picture
	
	var orientation = "RIGHT";//This is the default direction of the sprite
	var moving = 128;//moving will be use for the cutting from the image
	var changing = false;//If there is a change of orientation, this value will be true
	var moveX = 250;
	var moveY = 250;*/
		

	//Listener added in order to execute actions depending the key pressed
	/*canvas.addEventListener("keydown", function (event) {
		console.log("MOVE?");
		if (!event.defaultPrevented) {
			switch (event.key) {
				case 40:
					
					if (orientation != "DOWN") {
						changing = true;
						orientation = "DOWN";
					}
				
				break;
				case 38:
					if (orientation != "UP") {
					changing = true;
					orientation = "UP";
					}
				
				break;
				case 37:
					if (orientation != "LEFT") {
					changing = true; 
					orientation = "LEFT";
					}
				
				break;				
				case 39:
					console.log("move RIGHT");
					if (orientation != "RIGHT") {
					changing = true;
					orientation = "RIGHT";
					}
					requestAnimationFrame(stepImg);
				break;
				
				default:
				break;
			}
		}
	}, false);

	

	function stepImg() {
		context.clearRect(0,0,canvas.width,canvas.height);
		if (changing) {
			moving = 0;
			changing = false;
		}
		switch (orientation) {
			case "DOWN":
				//context.drawImage(image,moving,
			break;
			case "UP":
			
			break;
			case "LEFT":
			
			break;
			case "RIGHT":
			moveX += 20;
				context.drawImage(image, moving, 128, 128, 128, moveX,128,128,128);
				moving += 128;
			break;
			default:
			
			break;
		}
		if (moving < 512) requestAnimationFrame(stepImg);
		else {
			moving = 0;
			requestAnimationFrame(stepImg);
		}
	}*/


    </script>
